{
    "version": "{{ version|required('version') }}",
    "status": "{{ status|required('status') }}",
    "id": "{{ id|required('id') }}",
    "label": "{{ dataset_label|required('dataset_label') }}",
    "dataset": {
        {%- if dataset is defined  -%}
        "id": "{{ dataset.id }}",
        "default": "{{ dataset.default }}",        
        "description": {{ dataset.description|escape_chars }},
        "label": "{{ dataset.label }}",
        "how_to_cite": "{{ dataset.how_to_cite }}",
        "image": "{{ dataset.image }}",
        "doi": "{{ dataset.doi }}",
        "publication_date": "{{ dataset.publication_date }}",
        "contact": {
            "name": "{{ dataset.contact.name }}",
            "email": "{{ dataset.contact.email }}",
            "webpage": "{{ dataset.contact.webpage }}"
        },
        "license": {
            "name": "{{ dataset.license.name }}",
            "url": "{{ dataset.license.url }}"
        },
        "keywords": "{{ dataset.keywords }}",
        "related_data":
        [
            {%- for data in dataset.related_data -%}
                {
                    "name": "{{ data.name }}",
                    "url": "{{ data.url }}"
                }
            {{ ", " if not loop.last else "" }}
            {%- endfor -%}
        ],
        "products":
        [
            {%- for prod in dataset.products -%}
                {
                    "id": "{{ prod.id }}",
                    "label": "{{ prod.label }}"
                }
            {{ ", " if not loop.last else "" }}
            {%- endfor -%}
        ]
    {%- endif -%}
    },
    "widgets":
        [
            {%- for widget in widgets -%}
                {
                    "name": "{{ widget.name }}",
                    "label": "{{ widget.label }}",
                    "required": "{{ widget.required }}",
                    "parameter": "{{ widget.parameter }}",
                    "type": "{{ widget.type }}",
                    "help": "{{ widget.help }}",
                    "info": "{{ widget.info }}",
                    "details": {
                        "values": 
                        [
                            {%- for val in values -%}
                                {
                                    "values": "{{ val.value }}",
                                    "label": "{{ val.label }}"
                                }
                            {{ ", " if not loop.last else "" }}
                            {%- endfor -%}    
                        ]
                    }
                }
            {{ ", " if not loop.last else "" }}
            {%- endfor -%}        
        ],
    "widgets_order": [
        {%- for order in widgets_order -%}
        "{{ order}} "
        {{ ", " if not loop.last else "" }}
        {%- endfor -%}
    ]
}